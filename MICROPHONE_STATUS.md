# 실시간 마이크 모니터링 상태

## ✅ 현재 구현 상태

### 실시간 오디오 모니터링이 작동 중입니다!

1. **마이크 접근**: `navigator.mediaDevices.getUserMedia()` 사용
2. **분석 주기**: **3초마다** 오디오 데이터 수집 및 AI 분석
3. **대상 구역**: **A동 1층**만 실시간 분석
4. **AI 판별**: Python ML 서비스로 위험 소리 감지

## 🔄 작동 흐름

```
[브라우저 마이크]
    ↓ (3초마다)
[오디오 데이터 수집]
    ↓
[데이터 변환 (8064개 값)]
    ↓
[POST /api/audio/analyze]
    ↓
[Python ML 서비스]
    ↓
[AI 예측 결과]
    ↓
[위험 감지?]
    ├─ Yes → 빨간색 경고 표시 + 이벤트/알림 생성
    └─ No → 정상 상태 유지
```

## 📋 작동 조건

### ✅ 작동하려면:
1. **마이크 활성화**: 환경설정에서 마이크가 켜져 있어야 함
2. **브라우저 권한**: 마이크 접근 권한 허용 필요
3. **Python ML 서비스**: `http://localhost:5000` 실행 중이어야 함
4. **백엔드 서버**: `http://localhost:8080` 실행 중이어야 함

### ❌ 작동하지 않을 때:
- 환경설정에서 마이크가 꺼져 있음
- 브라우저에서 마이크 권한을 거부함
- Python ML 서비스가 실행되지 않음
- 백엔드 서버가 실행되지 않음

## 🔍 확인 방법

### 1. 브라우저 콘솔 확인 (F12)
```javascript
// 정상 작동 시:
✅ AI 분석 성공: { isDangerous: false, predictedClass: 0, ... }

// 마이크 접근 실패 시:
❌ 마이크 접근 실패: NotAllowedError: Permission denied
```

### 2. 환경설정 확인
- `/settings` 페이지 접속
- "마이크 활성화" 토글이 켜져 있는지 확인

### 3. 네트워크 탭 확인 (F12)
- 3초마다 `POST /api/audio/analyze` 요청이 있는지 확인
- 응답 상태가 200 OK인지 확인

### 4. Python ML 서비스 확인
```bash
# 터미널에서 확인
# Python ML 서비스가 실행 중이어야 함
# http://localhost:5000/api/health 접속 시 응답 확인
```

## 🎯 현재 설정

- **분석 주기**: 3초
- **샘플링 레이트**: 16000 Hz
- **채널**: 모노 (1채널)
- **데이터 크기**: 8064개 값 (128×63×1)
- **대상 구역**: A동 1층만

## 📊 실시간 상태 표시

### Main 페이지에서:
- **A동 1층**: 
  - 🟢 초록색 = 정상 소리
  - 🔴 빨간색 = 위험 소리 감지
  - 마이크 비활성화 시 = "마이크 비활성화" 메시지

### 콘솔 로그:
- `✅ AI 분석 성공` = 정상 작동
- `⚠️ AI 분석 실패` = 분석 실패 (에러 확인 필요)
- `❌ 마이크 접근 실패` = 마이크 권한 문제

## 🔧 문제 해결

### 마이크가 작동하지 않을 때:

1. **브라우저 권한 확인**
   - 주소창 왼쪽 자물쇠 아이콘 클릭
   - 마이크 권한이 "허용"인지 확인

2. **환경설정 확인**
   - `/settings` 페이지에서 마이크 활성화 확인

3. **서비스 실행 확인**
   - Python ML 서비스 실행 중인지 확인
   - 백엔드 서버 실행 중인지 확인

4. **콘솔 에러 확인**
   - F12 → Console 탭에서 에러 메시지 확인

